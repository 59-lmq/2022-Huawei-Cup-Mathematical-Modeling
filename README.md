# 2022-Huawei-Cup-Mathematical-Modeling
2022年华为杯数学建模竞赛，E题个人思路
问题二：请根据附件3土壤湿度数据、附件4土壤蒸发数据以及附件8中降水等数据，建立模型对保持目前放牧策略不变情况下对2022年、2023年不同深度土壤湿度进行预测，并完成下表。
## 一、问题分析
从题目描述分析，是建立预测模型。而同时，观察附件3、附件4及附件8中的数据，可以主观地发现，土壤湿度的变化主要与土壤蒸发量、降水量有关。
从12个 单个月份不同年份的不同深度土壤湿度 的曲线可以观察出，某个月份的不同深度土壤湿度是随时间变化而变化的，而且变化趋势基本相同。
所以可以采用时间序列预测模型，这里我采用的是LSTM。
此外，根据题目扩展阅读中的地表降水模型：
土壤含水量-降水量-地表蒸发模型
![img](file:///.\readme_figure\wps1.png)
                                                    
式中，P为该牧区供水率（主要为降水）；E为地表蒸散发率；β为土壤含水量；

土壤湿度还与土壤蒸发量呈负相关、与降水量呈正相关。
所以可以使用多变量LSTM，输出目标是未来的不同深度土壤湿度，即可以简单理解为输入维度是 6, 包括往年四个不同深度的土壤湿度、土壤蒸发量以及降水量。而输出就是预测的下一年该月份的四个不同深度的土壤湿度。

在确定预测模型后，进行数据集清洗、训练、评价、预测，就可以求解本问题。
## 二、数据预处理
第一步，合并附件3、附件4以及附件8中的数据，并根据月份，划分成12个单独的数据。同时去除非自变量的列。
第二步，因时间较短，设置了seq_length=1，即步长为1，还要划分每个月份的训练集和测试集。
数据预处理完毕。
## 三、训练模型
第一步，搭建LSTM网络。
第二步，设置训练参数。batch-size=1, seq-length=1, hidden_size=6, num_layers=2, lr=0.001等等。
第三步，进行训练。使用Adam优化器，MSE损失函数。
第四步，对训练好的模型，进行评价。评价指标采用MAE、R2.
## 四、预测
第一步，导入模型。
第二步，构建输入数据。
第三步，得到预测数据。
